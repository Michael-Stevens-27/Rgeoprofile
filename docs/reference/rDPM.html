<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Draw from Dirichlet process mixture model — rDPM • Rgeoprofile</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Draw from Dirichlet process mixture model — rDPM" />
<meta property="og:description" content="Provides random draws from a 2D spatial Dirichlet process mixture model. Both sigma and tau are defined in units of kilometres, representing the average distance that an observations lies from a source, and the average distance that a source lies from the centre point respectively. In contrast, the location of the centre point and the locations of the final output crime sites are defined in units of degrees lat/long to facilitate spatial analysis." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rgeoprofile</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Install_R.html">Installing R and Rstudio</a>
    </li>
    <li class="dropdown-header">Intro to R part 1</li>
    <li class="dropdown-header">Intro to R part 2</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    GP tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/Basic_Rgeoprofile.html">Basic Rgeoprofile</a>
    </li>
    <li>
      <a href="../articles/Data_Rgeoprofile.html">Real world data</a>
    </li>
    <li>
      <a href="../articles/Advanced_Rgeoprofile.html">Advanced Rgeoprofile</a>
    </li>
    <li>
      <a href="../reference/index.html">Function list</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">General R</li>
    <li class="dropdown-header">Spatial Analysis in R</li>
    <li class="dropdown-header">Ecology in R</li>
  </ul>
</li>
<li>
  <a href="../articles/Acknowledgements.html">Acknowledgements</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Michael-Stevens-27/Rgeoprofile">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Draw from Dirichlet process mixture model</h1>
    
    <div class="hidden name"><code>rDPM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides random draws from a 2D spatial Dirichlet process mixture model. Both sigma and tau are defined in units of kilometres, representing the average distance that an observations lies from a source, and the average distance that a source lies from the centre point respectively. In contrast, the location of the centre point and the locations of the final output crime sites are defined in units of degrees lat/long to facilitate spatial analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>rDPM</span>(<span class='kw'>n</span>, sigma = <span class='fl'>1</span>, tau = <span class='fl'>10</span>, priorMean_longitude = <span class='op'>-</span><span class='fl'>0.1277</span>,
  priorMean_latitude = <span class='fl'>51.5074</span>, alpha = <span class='fl'>1</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>number of draws.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>standard deviation of dispersal distribution, in units of kilometres.</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>standard deviation of prior on source locations (i.e. average distances of sources from centre point), in units of kilometres.</p></td>
    </tr>
    <tr>
      <th>priorMean_longitude</th>
      <td><p>location of prior mean on source locations in degrees longitude.</p></td>
    </tr>
    <tr>
      <th>priorMean_latitude</th>
      <td><p>location of prior mean on source locations in degrees latitude.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>concentration parameter of Dirichlet process model. Large alpha implies many distinct sources, while small alpha implies only a few sources.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Output includes the lat/long locations of the points drawn from the DPM model, along with the underlying group allocation (i.e. which points belong to which sources) and the lat/long locations of the sources.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># produces clusters of points from sources centred on QMUL</span>
<span class='fu'>rDPM</span>(<span class='fl'>50</span>, priorMean_longitude = <span class='op'>-</span><span class='fl'>0.04217491</span>, priorMean_latitude = <span class='fl'>51.5235505</span>, 
alpha=<span class='fl'>1</span>, sigma=<span class='fl'>1</span>, tau=<span class='fl'>3</span>) 
</div><div class='output co'>#&gt; $longitude
#&gt;  [1] -0.07071854 -0.02899804 -0.08771382 -0.06063891 -0.05081275 -0.04295398
#&gt;  [7] -0.08024408 -0.08588012 -0.04688169 -0.06268836 -0.04944622 -0.09847647
#&gt; [13] -0.08324485 -0.08204795 -0.08332704 -0.07477592 -0.08333785 -0.06907868
#&gt; [19] -0.06008887 -0.05604290 -0.04727986 -0.03809947 -0.05241117 -0.04656367
#&gt; [25] -0.05658988 -0.04184298 -0.05515293 -0.06824218 -0.07023678 -0.08074805
#&gt; [31] -0.07032612 -0.07124752 -0.04931582 -0.03654662 -0.07870685 -0.05670027
#&gt; [37] -0.06895669 -0.03947111 -0.02143175 -0.07923767 -0.05294911 -0.04771011
#&gt; [43] -0.03563374 -0.05524491 -0.05768169 -0.06055662 -0.08225426 -0.03372259
#&gt; [49] -0.04556177 -0.06362325
#&gt; 
#&gt; $latitude
#&gt;  [1] 51.52584 51.52324 51.52257 51.55419 51.56708 51.53826 51.55694 51.53849
#&gt;  [9] 51.55560 51.55927 51.54075 51.54592 51.55142 51.54652 51.54898 51.55309
#&gt; [17] 51.56059 51.55001 51.55843 51.54856 51.53302 51.50969 51.51419 51.50316
#&gt; [25] 51.52075 51.51032 51.52270 51.51689 51.52543 51.52807 51.51448 51.53390
#&gt; [33] 51.52167 51.53866 51.52464 51.53643 51.52144 51.51366 51.52650 51.52379
#&gt; [41] 51.52646 51.51488 51.53650 51.51471 51.52716 51.53201 51.53377 51.52678
#&gt; [49] 51.54778 51.51926
#&gt; 
#&gt; $group
#&gt;  [1] 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
#&gt; [39] 3 3 3 3 3 3 3 4 4 4 4 4
#&gt; 
#&gt; $source_lon
#&gt; [1] -0.06319340 -0.07051169 -0.05491319 -0.05418676
#&gt; 
#&gt; $source_lat
#&gt; [1] 51.52723 51.55234 51.52360 51.52733
#&gt; </div><div class='input'><span class='co'># same, but increasing alpha to generate more clusters</span>
<span class='fu'>rDPM</span>(<span class='fl'>50</span>, priorMean_longitude = <span class='op'>-</span><span class='fl'>0.04217491</span>, priorMean_latitude = <span class='fl'>51.5235505</span>, 
alpha=<span class='fl'>5</span>, sigma=<span class='fl'>1</span>, tau=<span class='fl'>3</span>)
</div><div class='output co'>#&gt; $longitude
#&gt;  [1] -0.061458998 -0.065096832 -0.090627180 -0.033639377 -0.067317680
#&gt;  [6] -0.072873141 -0.054903906 -0.088553324 -0.052818062 -0.068406517
#&gt; [11] -0.068670395 -0.075435216 -0.077219666 -0.093906576 -0.077233993
#&gt; [16] -0.057958761 -0.063142057 -0.077650794 -0.056754804 -0.084389700
#&gt; [21] -0.181289807 -0.043056277 -0.051620131 -0.058691234 -0.059084960
#&gt; [26] -0.054965546 -0.049463734 -0.092965203 -0.072625624 -0.028639055
#&gt; [31] -0.042124330 -0.065138739 -0.098644358 -0.008862761  0.001735281
#&gt; [36] -0.058866670 -0.054428014 -0.062696864  0.083018383  0.052715845
#&gt; [41]  0.044991475  0.051404010  0.053632711 -0.014155753 -0.004476909
#&gt; [46] -0.017540070 -0.038706409 -0.067930741 -0.046534400 -0.064108698
#&gt; 
#&gt; $latitude
#&gt;  [1] 51.49486 51.48571 51.49031 51.48818 51.48582 51.49876 51.49946 51.50339
#&gt;  [9] 51.48312 51.48938 51.51359 51.49072 51.49058 51.49709 51.49612 51.49460
#&gt; [17] 51.49490 51.49851 51.49414 51.50446 51.51423 51.52036 51.53052 51.53469
#&gt; [25] 51.54347 51.53796 51.53846 51.52933 51.55056 51.53481 51.53678 51.53571
#&gt; [33] 51.53803 51.54142 51.53741 51.46538 51.46673 51.46022 51.50970 51.51586
#&gt; [41] 51.51418 51.51411 51.49698 51.47799 51.55014 51.53707 51.54577 51.54968
#&gt; [49] 51.54694 51.55003
#&gt; 
#&gt; $group
#&gt;  [1]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  3  3  3  3
#&gt; [26]  3  3  3  3  3  3  3  4  5  5  6  6  6  7  7  7  7  7  8  9  9 10 10 10 11
#&gt; 
#&gt; $source_lon
#&gt;  [1] -0.0692210482 -0.1613950217 -0.0499750105 -0.0897163773 -0.0008425913
#&gt;  [6] -0.0708127995  0.0571507630 -0.0240175762 -0.0169510090 -0.0511232717
#&gt; [11] -0.0465658585
#&gt; 
#&gt; $source_lat
#&gt;  [1] 51.49346 51.50904 51.53707 51.52453 51.53592 51.48248 51.51158 51.47571
#&gt;  [9] 51.53809 51.54304 51.53928
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bob Verity, Michael Stevens, Sally Faulkner, Steven Le Comber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


