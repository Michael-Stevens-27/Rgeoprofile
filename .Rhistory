plot(5)
# Rgeoprofile_deploy.R
# Author: Bob Verity
# Date: 2017-05-26
# Purpose:
# Test and demonstrate use of RgeoProfile package.
# ------------------------------------------------------------------
library(devtools)
getwd()
load_all()
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
check('RgeoProfile', args="--no-examples")
check('.', args="--no-examples")
devtools::load_all(".")
# define parameters and draw some data
n <- 1e2
sigma_mean <- 1
sigma_var <- 1
sigma <- sigma_mean
tau <- 10
alpha <- 10
DPM_draws = rDPM(n, sigma=sigma, tau=tau, alpha=alpha, priorMean_longitude=-0.035, priorMean_latitude=51.52)
simData <- geoData()
simData
devtools::load_all(".")
simData <- geoData()
DPM_draws = rDPM(n, sigma=sigma, tau=tau, alpha=alpha, priorMean_longitude=-0.035, priorMean_latitude=51.52)
# some options for data
# Note that Cholera and LondonExample_crimes are already loaded by default
simData <- geoData(DPM_draws$longitude, DPM_draws$latitude)
# some options for sources
# Note that WaterPumps and LondonExample_sources are already loaded by default
simSource <- geoDataSource(DPM_draws$source_lon, DPM_draws$source_lat)
# choose data and sources from options above
data <- LondonExample_crimes
source <- LondonExample_sources
# set model and MCMC parameters
params = geoParams(data = data, sigma_mean = sigma_mean, sigma_var = NULL, sigma_squared_shape = 2, chains = 5, burnin = 1e3, samples = 1e4, longitude_cells = 200, latitude_cells = 200)
params
map1 <- geoPlotMap(params, data=data, source=source)
map1
dev.new()
geoPlotSigma(params = params)
geoPlotSigma(params = params)
m = geoMCMC(data = data, params = params)
geoPlotSigma(params = params, mcmc = m)
abline(v = sigma, col=2)
geoPlotAllocation(mcmc = m)
geoPlotCoallocation(mcmc = m)
map2 <- geoPlotMap(params = params, data = data, source = source, surface = m$geoProfile, breakPercent = seq(0,50,l=21), opacity = 0.8)
map2
map3 <- geoPlotMap(lonLimits = c(-0.06,-0.02), latLimits = c(51.52, 51.54), params = params, data = data, source = source, surface = m$geoProfile, breakPercent = seq(0,50,l=21), opacity = 0.8)
map3 <- geoPlotMap(lonLimits = c(-0.06,-0.02), latLimits = c(51.52, 51.54), params = params, data = data, source = source, surface = m$geoProfile, breakPercent = seq(0,50,l=21), opacity = 0.8)
map3 <- geoPlotMap(lonLimits = c(-0.06,-0.02), latLimits = c(51.52, 51.54), params = params, data = data, source = source, surface = m$geoProfile, breakPercent = seq(0,50,l=21), opacity = 0.8)
map3
geoPersp(surface = m$geoProfile, aggregate_size = 1)
hs <- geoReportHitscores(params = params, source = source, surface =m$geoProfile)
hs
Gini <- geoPlotLorenz(hit_scores = hs)
Gini
geoModelSources(mcmc = m, data = data)
surface_ring <- geoRing(params = params, data = data, source = source, mcmc = m)
gp_ring <- geoProfile(surface = surface_ring)
map4 <- geoPlotMap(params = params, data = data, source = source, surface = gp_ring, opacity = 1, breakPercent = seq(0,50,l=21))
map4
hs_ring <- geoReportHitscores(params = params, source = source, surface = gp_ring)
hs_ring
Gini <- geoPlotLorenz(hit_scores = hs_ring)
Gini
devtools::load_all(".")
check('.', args="--no-examples")
# Rgeoprofile_deploy.R
# Author: Bob Verity
# Date: 2017-05-26
# Purpose:
# Test and demonstrate use of RgeoProfile package.
# ------------------------------------------------------------------
library(devtools)
# RStudio shortcuts:
#    cmd+shift+L     : load_all
#    cmd+shift+D     : document (NB, option must be activated in Build Tools)
#    cmd+shift+E     : check
# check('.', args="--no-examples")
# ------------------------------------------------------------------
#set.seed(1)
# define parameters and draw some data
n <- 1e2
sigma_mean <- 1
sigma_var <- 1
sigma <- sigma_mean
tau <- 10
alpha <- 10
DPM_draws = rDPM(n, sigma=sigma, tau=tau, alpha=alpha, priorMean_longitude=-0.035, priorMean_latitude=51.52)
devtools::load_all(".")
# Rgeoprofile_deploy.R
# Author: Bob Verity
# Date: 2017-05-26
# Purpose:
# Test and demonstrate use of RgeoProfile package.
# ------------------------------------------------------------------
library(devtools)
# RStudio shortcuts:
#    cmd+shift+L     : load_all
#    cmd+shift+D     : document (NB, option must be activated in Build Tools)
#    cmd+shift+E     : check
# check('.', args="--no-examples")
# ------------------------------------------------------------------
#set.seed(1)
# define parameters and draw some data
n <- 1e2
sigma_mean <- 1
sigma_var <- 1
sigma <- sigma_mean
tau <- 10
alpha <- 10
DPM_draws = rDPM(n, sigma=sigma, tau=tau, alpha=alpha, priorMean_longitude=-0.035, priorMean_latitude=51.52)
simData <- geoData(DPM_draws$longitude, DPM_draws$latitude)
simSource <- geoDataSource(DPM_draws$source_lon, DPM_draws$source_lat)
data <- LondonExample_crimes
source <- LondonExample_sources
params = geoParams(data = data, sigma_mean = sigma_mean, sigma_var = NULL, sigma_squared_shape = 2, chains = 5, burnin = 1e3, samples = 1e4, longitude_cells = 200, latitude_cells = 200)
map1 <- geoPlotMap(params = params, data = data, source = source)
map1
# plot prior on sigma
geoPlotSigma(params = params)
m = geoMCMC(data = data, params = params)
geoPlotSigma(params = params, mcmc = m)
abline(v = sigma, col = 2)
geoPlotAllocation(mcmc = m)
geoPlotCoallocation(mcmc = m)
map2 <- geoPlotMap(params = params, data = data, source = source, surface = m$geoProfile, breakPercent = seq(0,50,l=21), opacity = 0.8)
map2
map3 <- geoPlotMap(lonLimits = c(-0.06,-0.02), latLimits = c(51.52, 51.54), params = params, data = data, source = source, surface = m$geoProfile, breakPercent = seq(0,50,l=21), opacity = 0.8)
map3
geoPersp(surface = m$geoProfile, aggregate_size = 1)
hs <- geoReportHitscores(params = params, source = source, surface =m$geoProfile)
hs
Gini <- geoPlotLorenz(hit_scores = hs)
Gini
geoModelSources(mcmc = m, data = data)
surface_ring <- geoRing(params = params, data = data, source = source, mcmc = m)
gp_ring <- geoProfile(surface = surface_ring)
map4 <- geoPlotMap(params = params, data = data, source = source, surface = gp_ring, opacity = 1, breakPercent = seq(0,50,l=21))
map4 <- geoPlotMap(params = params, data = data, source = source, surface = gp_ring, opacity = 1, breakPercent = seq(0,50,l=21))
map4 <- geoPlotMap(params = params, data = data, source = source, surface = gp_ring, opacity = 1, breakPercent = seq(0,50,l=21))
map4 <- geoPlotMap(params = params, data = data, source = source, surface = gp_ring, opacity = 1, breakPercent = seq(0,50,l=21))
map4 <- geoPlotMap(params = params, data = data, source = source, surface = gp_ring, opacity = 1, breakPercent = seq(0,50,l=21))
map4
hs_ring <- geoReportHitscores(params = params, source = source, surface = gp_ring)
hs_ring
Gini <- geoPlotLorenz(hit_scores = hs_ring)
Gini
north_london_mask <- geoShapefile()
prob_masked <- geoMask(m$posteriorSurface, params, north_london_mask, operation="inside", scaleValue=1)
gp_masked <- geoProfile(prob_masked$prob)
map5 <- geoPlotMap(params, data=data, source=source, surface=gp_masked, opacity=0.8)
map5 <- geoPlotMap(params, data=data, source=source, surface=gp_masked, opacity=0.8)
map5
map2
devtools::load_all(".")
check('.', args="--no-examples")
devtools::load_all(".")
LondonExample_crimes
LondonExample_sources
devtools::load_all(".")
devtools::load_all(".")
